<?xml version="1.0" encoding="UTF-8"?>
<!-- æ³¨æ„æµ‹è¯•é…ç½®æ–‡ä»¶ï¼Œä¸è¦å°†æ—¥å¿—è¾“å‡ºè¯­å¥æ”¾åœ¨"SpringApplication.run(args)ä¹‹å‰ï¼Œä¼šéƒ½æ‰“å°çš„" -->
<!--
scanï¼šé…ç½®æ–‡ä»¶å‘ç”Ÿæ”¹åŠ¨ï¼Œä¼šé‡æ–°åŠ è½½
scanPeriodï¼šè®¾ç½®æ¯è¿‡å¤šå°‘ç§’æ£€æµ‹é…ç½®æ–‡ä»¶æœ‰æ²¡æœ‰æ”¹åŠ¨
debugï¼šæ˜¯å¦æ‰“å°logbackæ¡†æž¶çš„æ—¥å¿—
-->
<configuration scan="true" scanPeriod="60 seconds" debug="false">

    <!-- è®¾ç½®ä¸Šä¸‹æ–‡åç§°
        æ¯ä¸ªloggeréƒ½å…³è”åˆ°loggerä¸Šä¸‹æ–‡ï¼Œé»˜è®¤ä¸Šä¸‹æ–‡åç§°ä¸ºâ€œdefaultâ€
        ä½†å¯ä»¥ä½¿ç”¨è®¾ç½®æˆå…¶ä»–åå­—ï¼Œç”¨äºŽåŒºåˆ†ä¸åŒåº”ç”¨ç¨‹åºçš„è®°å½•ã€‚ä¸€æ—¦è®¾ç½®ï¼Œä¸èƒ½ä¿®æ”¹
    -->
    <contextName>core</contextName>

    <!-- å¼•å…¥é»˜è®¤çš„æ—¥å¿—é…ç½® -->
    <include resource="org/springframework/boot/logging/logback/defaults.xml" />

    <!-- å…¶ä»–1ã€jmxåŠ¨æ€æŽ§åˆ¶æ—¥å¿—çº§åˆ«(springboot Admin) -->
    <!-- <jmxConfigurator/> -->

    <!-- å…¶ä»–2ã€å®šä¹‰å˜é‡ï¼ŒFILEè¾“å‡ºæŒ‡å®šè·¯å¾„ä½¿ç”¨æ”¹å˜é‡ --> -->
     <property name="LOG_HOME" value="d:\log\Working-Temp" />


    <!-- å®šä¹‰è¾“å‡ºåˆ°æŽ§åˆ¶å°çš„æ—¥å¿—çº§åˆ«ã€æ ¼å¼ç­‰ï¼ˆç›¸åŒç›®æ ‡çš„Appenderå¯ä»¥æœ‰å¤šä¸ªï¼‰ -->
    <appender name ="CONSOLE_NOT_ERROR" class="ch.qos.logback.core.ConsoleAppender">
        <!-- é…ç½®å½±å“çš„çº§åˆ«ï¼šappenderä¸­çš„filteræœ‰ä¸¤ç§æ–¹å¼é…ç½®â€œThresholdFilterâ€å’Œâ€œLevelFilterâ€ -->
        <!--<filter class="ch.qos.logback.classic.filter.ThresholdFilter">-->
            <!--<level>INFO</level>-->
        <!--</filter>-->
        <filter class="ch.qos.logback.classic.filter.LevelFilter">
            <level>ERROR</level>
            <!-- åŒ¹é…çš„çº§åˆ«æŽ¥å— -->
            <onMatch>DENY</onMatch>
            <!-- ä¸åŒ¹é…çš„çº§åˆ«ï¼šä¸æŽ¥å— -->
            <onMismatch>ACCEPT</onMismatch>
        </filter>
        <encoder>
            <pattern>
                <!-- èµ„æ–™æ¥æºï¼š
                    1ã€æµ‹è¯•
                    2ã€log4j2çš„ç¬”è®°
                    3ã€æºç ï¼šch.qos.logback.classic.PatternLayout
                    4ã€å®˜æ–¹æ–‡æ¡£ï¼šhttp://logback.qos.ch/manual/layouts.html
                 -->
                <!-- 1ã€é¢œè‰²
                    %clr(æ—¥å¿—å†…å®¹){é¢œè‰²ï¼šfainté»‘è‰²ã€cyanæ©„æ¦„è“ã€magentaç´«çº¢}ï¼šå°†å°æ‹¬å·çš„å†…å®¹ä»¥æŒ‡å®šçš„é¢œè‰²è¾“å‡º
                    %clr(æ—¥å¿—å†…å®¹)ï¼šå°†å°æ‹¬å·çš„å†…å®¹ä»¥å½“å‰æ—¥å¿—çº§åˆ«çš„é¢œè‰²è¾“å‡ºï¼šTRACEã€DEBUGã€INFO greenã€WARN  yellowã€ERRORã€FATAL red
                    è¿™æ ·ç»™æ—¥å¿—ä¸Šè‰²æœ€ç®€å•ï¼š%é¢œè‰²(æ—¥å¿—å†…å®¹) - ä½†æ˜¯å®žé™…å‡ºçŽ°äº†ï¼Œæœ¬åœ°æ²¡é—®é¢˜ï¼Œmeså‡ºçŽ°äº†è¿™æ ·ä¸Šè‰²å‡ºçŽ°ä¹±ç çš„æƒ…å†µâ€œ[0;39m [35m  40[0;39mâ€
                 -->

                <!-- 2ã€é»˜è®¤çš„æ—¥å¿—æ ¼å¼åŠå­—ç¬¦çš„ç‰¹æ®Šå«ä¹‰ï¼š
                    ${CONSOLE_LOG_PATTERN:-
                        %clr(%d{${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}}){faint}
                        %clr(${LOG_LEVEL_PATTERN:-%5p}) - %pï¼šå¤§å†™çš„æ—¥å¿—çº§åˆ«ã€5ï¼šé™åˆ¶æœ€å¤š5ä¸ªå­—ç¬¦ã€-ï¼šå³å¯¹é½
                        %clr(${PID:- }){magenta} - æ²¡æœ‰PIDæ—¶è¾“å‡ºâ€œ-â€
                        %clr(-&#45;&#45;){faint} - â€œ&#45;â€å°±æ˜¯â€œ-â€
                        %clr([%15.15t]){faint} - %tï¼šçº¿ç¨‹åã€15.15ï¼šæœ€å°‘15ä¸ªå­—ç¬¦ä¸”æœ€å¤š15ä¸ªå­—ç¬¦
                        %clr(%-40.40logger{39}){cyan} - %loggerï¼šç±»å
                        %clr(:){faint} %m%n
                        ${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}
                    }

                    %cn=%contextNameï¼šä¸Šä¸‹æ–‡åç§°
                    %d = %dateï¼šæ—¶é—´ åˆ¶å®šæ ¼å¼ç®€å•å†™æ³•ï¼š%d{yyyy-MM-dd HH:mm:ss}
                    %p=%le=%levelï¼šæ—¥å¿—çº§åˆ« ä¸€èˆ¬å†™æ³•ï¼š%-5p
                    %t = %threadï¼šçº¿ç¨‹å
                    %F=%fileï¼šæ–‡ä»¶å
                    %logger{é•¿åº¦}ï¼šè¾“å‡ºæ—¥å¿—çš„å®Œæ•´ç±»å æ²¡æœ‰å¤§æ‹¬å·ï¼šå±•ç¤ºå®Œæ•´ç±»åã€{0}ï¼šåªå±•ç¤ºç±»åã€å…¶ä»–æŒ‰ç…§ç»™å®šçš„é•¿åº¦å°½å¯èƒ½å±•ç¤ºå®Œæ•´ç±»å
                    %M=%methodï¼šæ–¹æ³•å
                    %L=%lineï¼šè¡Œå·
                    %m=%msg=%messageï¼šæ—¥å¿—å†…å®¹
                    %nï¼šæ¢è¡Œ
                    %X{key}=%mdc{key}ï¼šä»ŽMDCä¸­æ ¹æ®é”®å–å€¼
                    %ex{æ•°å­—}=%exception{æ•°å­—}=%throwable{æ•°å­—}ï¼šå¼‚å¸¸ç›¸å…³ %ex=%ex{full}ï¼šå®Œæ•´å¼‚å¸¸å †æ ˆä¿¡æ¯ã€%ex{short}ï¼šåªå±•ç¤ºå¼‚å¸¸ä¿¡æ¯åŠæŠ›å‡ºç±»çš„ä¸€å±‚å †æ ˆä¿¡æ¯ã€å…¶ä»–ï¼šæ•°å­—å‡ å°±æœ€å¤§å‡ å±‚å †æ ˆ
                    %xEx=%xException=%xThrowableï¼šåŒä¸Šï¼Œå°±æ˜¯å¤šäº†jarä¿¡æ¯
                    %property{key}ï¼šå–å¾—å®šä¹‰çš„å˜é‡çš„å€¼
                    %replace(æ—¥å¿—å†…å®¹){æ­£åˆ™, åŒ¹é…çš„è¦æ›¿æ¢æˆçš„å­—ç¬¦ä¸²}ï¼šæ›¿æ¢æ—¥å¿—å†…å®¹ä¸­çš„æŒ‡å®šå­—ç¬¦
                 -->

                %d{yyyy-MM-dd HH:mm:ss} %clr(%-5p) | %cyan(%-40.40logger{39} %4L) | %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}
            </pattern>
            <charset>UTF-8</charset>
        </encoder>
    </appender>

    <appender name ="CONSOLE_ERROR" class="ch.qos.logback.core.ConsoleAppender">
        <filter class="ch.qos.logback.classic.filter.LevelFilter">
            <level>ERROR</level>
            <onMatch>ACCEPT</onMatch>
            <onMismatch>DENY</onMismatch>
        </filter>
        <encoder>
            <pattern>
                %d{yyyy-MM-dd HH:mm:ss} %clr(%-5p) | %cyan(%-40.40logger{39} %4L) | %clr(%m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx})
            </pattern>
            <charset>UTF-8</charset>
        </encoder>
    </appender>

    <!-- è¾“å‡ºåˆ°æ–‡ä»¶ -->
    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <!-- æ–‡ä»¶è·¯å¾„ -->
        <File>${LOG_HOME}\study\logs\today.log</File>
        <encoder>
            <pattern>%date [%level] [%thread] %logger{60} [%file : %line] %msg%n</pattern>
            <charset>UTF-8</charset>
        </encoder>
        <!-- æ—¥å¿—ç­–ç•¥ï¼ˆæ¯å¤©äº§ç”Ÿä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼‰ -->
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <!-- æ—¥å¿—å‘½å:å•ä¸ªæ–‡ä»¶å¤§äºŽ2MB æŒ‰ç…§æ—¶é—´+è‡ªå¢ži ç”Ÿæˆlogæ–‡ä»¶ -->
            <!-- psï¼šæŒ‡å®šæ–‡ä»¶åï¼šç»“å°¾æ·»åŠ ".gz"ä¼šå¯ç”¨åŽ‹ç¼© -->
            <fileNamePattern>D:\Working-Temp\study\logs\%d{yyyy-MM-dd}.%i.log</fileNamePattern>
            <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
                <maxFileSize>2MB</maxFileSize>
            </timeBasedFileNamingAndTriggeringPolicy>
            <!-- æœ€å¤§æ—¥å¿—ä¿å­˜å¤©æ•°ï¼šä¿ç•™30å¤©æ—¥å¿— -->
            <maxHistory>30</maxHistory>

        </rollingPolicy>

        <!-- trueå åŠ è¿˜æ˜¯falseæ›¿æ¢ï¼Œå½“ç„¶æ˜¯trueå•Šï¼Œæ²¡ä»€ä¹ˆç”¨çš„é…ç½® -->
        <append>true</append>
    </appender>

    <!-- å¼‚æ­¥æ–¹å¼è¾“å‡ºåˆ°æ–‡ä»¶ï¼šå¯ä»¥æŒ‰åŒ…è£…è®¾è®¡æ¨¡å¼çš„æ–¹å¼åŽ»ç†è§£ -->
    <appender name="ASYNC-FILE" class="ch.qos.logback.classic.AsyncAppender">
        <!-- ä¸ä¸¢å¤±æ—¥å¿—ï¼ˆé»˜è®¤é˜Ÿåˆ—80%å·²æ»¡ï¼Œä¸¢å¼ƒTRACEã€DEBUGã€INFOçº§åˆ«çš„æ—¥å¿—ï¼‰ -->
        <discardingThreshold>0</discardingThreshold>
        <!-- æ›´æ”¹é»˜è®¤é˜Ÿåˆ—çš„æ·±åº¦ï¼Œé»˜è®¤256ï¼ˆä¼šå½±å“æ€§èƒ½ï¼‰ -->
        <queueSize>256</queueSize>
        <!-- æŒ‡å®šè¦åŒ…è£…çš„appenderï¼Œæœ€å¤šåªèƒ½æ·»åŠ ä¸€ä¸ª -->
        <appender-ref ref="FILE"/>
    </appender>

    <!-- ä»¥ä¸Šçš„appenderæ ‡ç­¾åªæ˜¯å®šä¹‰ï¼Œå®žé™…èµ·ä½œç”¨è¿˜è¦é…ç½®åˆ°è¿™é‡Œ -->
    <root level="INFO">
        <appender-ref ref="CONSOLE_NOT_ERROR"/>
        <appender-ref ref="CONSOLE_ERROR"/>
        <appender-ref ref="ASYNC-FILE"/>
    </root>

    <!-- æŒ‡å®šç‰¹å®šåŒ…ä¸‹å¯ä»¥è¾“å‡ºçš„æœ€ä½Žçº§åˆ«çš„æ—¥å¿— -->
    <logger name="priv.wmc" level="INFO" />

</configuration>